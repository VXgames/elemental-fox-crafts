<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Security Headers (Meta tags - fallback if server headers not configured) -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https://www.googletagmanager.com https://www.google-analytics.com https://js.stripe.com https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; img-src 'self' data: https:; connect-src 'self' https://www.google-analytics.com https://api.emailjs.com https://api.stripe.com; frame-src https://js.stripe.com; object-src 'none'; base-uri 'self'; form-action 'self';">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-Frame-Options" content="DENY">
    <meta http-equiv="X-XSS-Protection" content="1; mode=block">
    <meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin">
    <title>Commissions - Custom Requests - Elemental Fox Crafts</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <!-- Inline lightweight fallback: visible if external CSS fails to load -->
    <style>
        body{background:#fff;background-attachment:fixed}
        #css-warning{display:block;background:#ffdede;color:#550000;padding:.6rem;text-align:center;font-weight:700;border-radius:6px}
    </style>
    <link rel="stylesheet" href="./style.css" type="text/css">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600&family=Inter:wght@300;400;500&display=swap" rel="stylesheet">
</head>
<body>
    <div id="css-warning">Stylesheet not loaded — using fallback styles. If you see this, check the CSS link or server.</div>
    <header>
        <nav class="navbar">
            <a href="index.html" class="nav-brand">
                <img src="./assets/Logo/VectorFoxwhite.png" alt="Elemental Fox Crafts Logo" class="logo">
                <h1>Elemental Fox Crafts</h1>
            </a>
            <button class="mobile-menu-toggle" aria-label="Toggle navigation menu">
                <span></span>
                <span></span>
                <span></span>
            </button>
            <ul class="nav-links">
                <li class="nav-item"><a href="index.html">Home</a></li>
                <li class="nav-item nav-mega" role="menuitem">
                    <a href="shop.html" aria-haspopup="true" aria-expanded="false" aria-label="Shop - Click to view categories">Shop</a>
                    <div class="mega-dropdown" role="menu" aria-label="Shop Categories and Featured Items">
                        <div class="mega-dropdown-inner">
                            <div class="mega-left">
                                <ul class="mega-categories" role="list" aria-label="Product Categories">
                                    <li><a href="category-weaving.html" role="menuitem">Weaving Tools</a></li>
                                    <li><a href="category-copper.html" role="menuitem">Copper Works</a></li>
                                    <li><a href="category-wands.html" role="menuitem">Wands</a></li>
                                    <li><a href="category-cattoys.html" role="menuitem">Cat Toys</a></li>
                                    <li><a href="category-knives.html" role="menuitem">Knives</a></li>
                                </ul>
                            </div>
                            <div class="mega-right">
                                <!-- Featured items will be loaded dynamically by featured-items.js -->
                            </div>
                        </div>
                    </div>
                </li>
                <li class="nav-item"><a href="commissions.html">Commissions</a></li>
                <li class="nav-item"><a href="about.html">About</a></li>
                <li class="nav-item"><a href="contact.html">Contact</a></li>
                <li class="nav-item mobile-instagram-item">
                    <a href="https://www.instagram.com/elementalfoxcrafts/" target="_blank" rel="noopener noreferrer" class="mobile-instagram-icon" aria-label="Visit our Instagram">
                        <img src="./assets/icons/Instagram.png" alt="Instagram">
                    </a>
                </li>
            </ul>
        </nav>
                <button class="cart-toggle" aria-label="Open shopping cart">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="9" cy="21" r="1"></circle>
                <circle cx="20" cy="21" r="1"></circle>
                <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
            </svg>
            <span class="cart-badge">0</span>
        </button>
        <a href="https://www.instagram.com/elementalfoxcrafts/" target="_blank" rel="noopener noreferrer" class="header-instagram-icon" aria-label="Visit our Instagram">
            <img src="./assets/icons/Instagram.png" alt="Instagram">
        </a>
    </header>
    <!-- Cart Overlay -->
    <div class="cart-overlay"></div>

    <!-- Cart Sidebar -->
    <div class="cart-sidebar">
        <div class="cart-header">
            <h2>Shopping Cart</h2>
            <button class="cart-close" aria-label="Close cart">×</button>
        </div>
        <div class="cart-content">
            <div class="cart-empty">
                <p>Your cart is empty</p>
                <p style="font-size: 0.9rem; color: var(--muted);">Add items to get started</p>
            </div>
            <div class="cart-items">
                <!-- Cart items will be dynamically added here -->
            </div>
        </div>
        <div class="cart-footer">
            <div class="cart-total">
                <span class="cart-total-label">Total:</span>
                <span class="cart-total-amount">$0.00</span>
            </div>
            <button class="cart-checkout-btn">Proceed to Checkout</button>
        </div>
    </div>



    <main>
        <section class="page-header">
            <h2>Commissions - Custom Requests</h2>
        </section>
        
        <section class="commissions-content">
            <div id="success-message" style="display: none; background: #d4edda; color: #155724; padding: 1rem; border-radius: 4px; margin-bottom: 2rem; border: 1px solid #28a745;">
                <strong>Thank you!</strong> Your message has been sent successfully. I will get back to you soon.
            </div>
            
            <div class="commissions-info">
                <p class="commissions-intro">Question about custom requests?</p>
                <p class="commissions-subtitle">Fill out the form below and I'll get back to you right away.</p>
                
                <div class="commissions-instructions">
                    <p>To ensure your vision is perfectly captured, please provide as much detail as possible in your message. Key information includes the type of object you have in mind, the desired materials (e.g., wood species, metals), the preferred dimensions, the intended purpose or setting, as well as your ideal timeline. If you have a visual reference, such as a sketch, photo, or inspiration board, you are welcome to attach it—supported file sizes are up to 10MB. The more you can share, the better I can bring your unique piece to life!</p>
                </div>
                
                <div class="contact-details">
                    <p><strong>Email:</strong> <a href="mailto:elementalfoxcrafts@proton.me">elementalfoxcrafts@proton.me</a></p>
                    <p><strong>Phone:</strong> <a href="tel:+1234567890">(123) 456-7890</a></p>
                </div>
            </div>
            
            <form class="commissions-form" id="commissionsForm" action="https://formsubmit.co/elementalfoxcrafts@proton.me" method="POST" enctype="multipart/form-data" data-validate>
                <input type="hidden" name="_subject" value="Custom Request from Elemental Fox Crafts Website">
                <input type="hidden" name="_captcha" value="false">
                <input type="hidden" name="_template" value="box">
                <input type="hidden" name="_autoresponse" value="Thank you for your custom request inquiry! I will get back to you soon.">
                <h3>Tell us what you need</h3>
                
                <label for="fullName">Full Name</label>
                <input type="text" id="fullName" name="fullName" placeholder="Full Name" required>
                
                <label for="email">Email</label>
                <input type="email" id="email" name="email" placeholder="Email" required>
                
                <label for="message">Message</label>
                <textarea id="message" name="message" placeholder="Message" rows="8" required></textarea>
                
                <label for="attachment">Image Attachment (Optional)</label>
                <input type="file" id="attachment" name="attachment" accept="image/*" />
                <p class="file-size-note">Maximum file size: 10MB. Accepted formats: JPG, PNG, GIF, WebP</p>
                <div id="file-warning" class="file-warning" style="display: none;"></div>
                <div id="file-info" class="file-info" style="display: none;"></div>
                
                <p class="captcha-note">This site is protected by reCAPTCHA and the Google Privacy Policy and Terms of Service apply.</p>
                
                <button type="submit" class="btn-primary">Send</button>
            </form>
        </section>
    </main>

    <footer>
        <a href="https://www.instagram.com/elementalfoxcrafts/" target="_blank" rel="noopener noreferrer" class="social-icon instagram-icon-footer" aria-label="Visit our Instagram">
            <img src="./assets/icons/Instagram.png" alt="Instagram">
        </a>
        <p>&copy; 2024 Elemental Fox Crafts. All rights reserved.</p>
    </footer>
    <script src="./assets/js/menu.js" defer></script>
    <script src="./assets/js/security.js" defer></script>
    <script src="./assets/js/error-handler.js" defer></script>
    <script src="./assets/js/form-validator.js" defer></script>
    <script src="./assets/js/featured-items.js" defer></script>
    <script>
        // Show success message if redirected after form submission
        if (window.location.search.includes('success=true')) {
            document.getElementById('success-message').style.display = 'block';
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
        
        // File size validation
        const MAX_FILE_SIZE = 10 * 1024 * 1024; // 10MB in bytes
        const fileInput = document.getElementById('attachment');
        const fileWarning = document.getElementById('file-warning');
        const fileInfo = document.getElementById('file-info');
        
        fileInput.addEventListener('change', function(e) {
            const file = e.target.files[0];
            fileWarning.style.display = 'none';
            fileInfo.style.display = 'none';
            
            if (file) {
                if (file.size > MAX_FILE_SIZE) {
                    fileWarning.style.display = 'block';
                    fileWarning.textContent = '⚠️ Warning: File is too large (' + formatFileSize(file.size) + '). Maximum size is 10MB. Please resize or compress your image.';
                    fileWarning.className = 'file-warning error';
                    fileInput.value = ''; // Clear the file input
                } else {
                    fileInfo.style.display = 'block';
                    fileInfo.textContent = '✓ File selected: ' + file.name + ' (' + formatFileSize(file.size) + ')';
                    fileInfo.className = 'file-info success';
                }
            }
        });
        
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return Math.round(bytes / Math.pow(k, i) * 100) / 100 + ' ' + sizes[i];
        }
        
        // Form submission handler
        document.getElementById('commissionsForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const form = this;
            
            // Check file size again before submission
            const file = fileInput.files[0];
            if (file && file.size > MAX_FILE_SIZE) {
                fileWarning.style.display = 'block';
                fileWarning.textContent = '⚠️ Warning: File is too large. Please select a smaller file.';
                fileWarning.className = 'file-warning error';
                return;
            }
            
            // Update subject with user's name
            const name = document.getElementById('fullName').value;
            const subjectInput = form.querySelector('input[name="_subject"]');
            if (subjectInput) {
                subjectInput.value = 'Custom Request from ' + name;
            }
            
            // Add redirect URL for success page
            const nextInput = document.createElement('input');
            nextInput.type = 'hidden';
            nextInput.name = '_next';
            nextInput.value = window.location.href.split('?')[0] + '?success=true';
            form.appendChild(nextInput);
            
            // Submit the form directly - FormSubmit will handle the file attachment
            form.submit();
        });
    </script>
</body>
</html>

